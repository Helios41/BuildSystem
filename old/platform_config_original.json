{
   "languages":
   {
      "C":
      {
         "platforms":
         [
            "Windows", ["X86_64", "X86"]
         ],
         "host": ["Windows", "X86_64"],
         "sources": [ ".c" ],
         "types":
         {
            "executable": 
            {
               "endings": ".exe",
               "commands":
               [  
                  "cd [BUILD_DIRECTORY]",
                  {
                     "if": "ARCH=X86",
                     "then": "vcvarsall x86"
                  },
                  {
                     "if": "ARCH=X86_64",
                     "then": "vcvarsall x86_amd64"
                  },
                  {
                     "if": "OPT=true",
                     "then": "cl /O2 /Fe[PROJECT_NAME] [SOURCES] /link [DEPENDENCIES]",
                     "else": "cl /Od /Fe[PROJECT_NAME] [SOURCES] /link [DEPENDENCIES]"
                  }
               ]
            },
            "dynamic": 
            {
               "endings": [".dll", ".lib"],
               "commands":
               [
                  "cd [BUILD_DIRECTORY]",
                  {
                     "if": "ARCH=X86",
                     "then": "vcvarsall x86"
                  },
                  {
                     "if": "ARCH=X86_64",
                     "then": "vcvarsall x86_amd64"
                  },
                  "echo LIBRARY [PROJECT_NAME] > ./exports.def",
                  "echo EXPORTS >> ./exports.def",
                  "(for %a in ([VAR exports]) do ( echo \t %a >> ./exports.def )) 1> nul",
                  {
                     "if": "OPT=true",
                     "then": "cl /O2 [SOURCES] /link /DLL /OUT:[PROJECT_NAME].dll /DEF:exports.def [DEPENDENCIES]",
                     "else": "cl /Od [SOURCES] /link /DLL /OUT:[PROJECT_NAME].dll /DEF:exports.def [DEPENDENCIES]"
                  }
               ]
            },
            "static": 
            {
               "endings": ".lib",
               "commands":
               [
                  "cd [BUILD_DIRECTORY]",
                  {
                     "if": "ARCH=X86",
                     "then": "vcvarsall x86"
                  },
                  {
                     "if": "ARCH=X86_64",
                     "then": "vcvarsall x86_amd64"
                  },
                  {
                     "if": "OPT=true",
                     "then": "cl /O2 /c [SOURCES]",
                     "else": "cl /Od /c [SOURCES]"
                  },
                  "lib /out:[PROJECT_NAME].lib *.obj"
               ]
            }
         }
      },
      "D":
      {
         "platforms": ["Windows", ["X86_64", "X86"]],
         "host": ["Windows", "X86_64"],
         "sources": [ ".d" ],
         "types":
         {
            "executable":
            {
               "endings": ".exe",
               "commands":
               [
                  "cd [BUILD_DIRECTORY]",
                  {
                     "if": "ARCH=X86",
                     "then": 
                     [
                        "dmd2vars32",
                        "dmd -of[PROJECT_NAME] [SOURCES]"
                     ]
                  },
                  {
                     "if": "ARCH=X86_64",
                     "then": 
                     [
                        "dmd2vars64",
                        "dmd -m64 -of[PROJECT_NAME].exe [SOURCES]"
                     ]
                  }
               ]
            }
         }
      }
   }
}
